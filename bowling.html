<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href='https://fonts.googleapis.com/css?family=DM Mono' rel='stylesheet'>
    <link rel="icon" type="image/x-icon" href="https://cdn-icons-png.flaticon.com/256/4325/4325930.png">
    <title> &#8286; BOWLING &#8286; </title>
    <style>
        canvas {
            z-index: -1;
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            width: 100vw;
            background-color: brown;
        }
    </style>
    </head>
    <body>
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@v0.152.2/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@v0.152.2/examples/jsm/"
            }
        }
    </script>
    <canvas id="name"></canvas>
    <script type="module">
        import * as THREE from 'three';
        import Stats from 'three/addons/libs/stats.module.js';
        import { GUI } from 'three/addons/libs/lil-gui.module.min.js';
        import RAPIER from 'https://cdn.skypack.dev/@dimforge/rapier3d-compat@0.11.2';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        class RapierDebugRenderer {
            mesh
            world
            enabled = false

            constructor(scene, world) {
                this.world = world
                this.mesh = new THREE.LineSegments(new THREE.BufferGeometry(), new THREE.LineBasicMaterial({ color: 0xffffff, vertexColors: true }))
                this.mesh.frustumCulled = false
                scene.add(this.mesh)
            }

            update() {
                if (this.enabled) {
                    const { vertices, colors } = this.world.debugRender()
                    this.mesh.geometry.setAttribute('position', new THREE.BufferAttribute(vertices, 3))
                    this.mesh.geometry.setAttribute('color', new THREE.BufferAttribute(colors, 4))
                    this.mesh.visible = true
                } else {
                    this.mesh.visible = false
                }
            }
        }

        await RAPIER.init() // This line is only needed if using the compat version
        const gravity = new RAPIER.Vector3(0.0, -9.81, 0.0)
        const world = new RAPIER.World(gravity)
        const scene = new THREE.Scene()
        const rapierDebugRenderer = new RapierDebugRenderer(scene, world)
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 100)
        const renderer = new THREE.WebGLRenderer({ antialias: true })
        renderer.setSize(window.innerWidth, window.innerHeight)
        renderer.toneMapping = THREE.ACESFilmicToneMapping
        renderer.shadowMap.enabled = true
        document.body.appendChild(renderer.domElement)
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight
            camera.updateProjectionMatrix()
            renderer.setSize(window.innerWidth, window.innerHeight)
        })
        scene.add(camera)
        camera.position.set(10, 10, 10)
    </script>
    <script src="help.js"></script>
    </body>
</html>
